PasswordStrengthMeter=function(n,t,i){(this.PasswordMeterDiv=document.getElementById(n+"_progressBar"),this.PasswordMeterDiv!=null)&&(this.ProgressBarId=n,this.PasswordTextBox=document.getElementById(t),this.PasswordTextBox!=null)&&(this.PropertySheetId=i,this.PasswordTextBox.PasswordStrengthManager=this,this.PasswordTextBox.onchange=PasswordStrengthMeter.TextChangedHandler,this.PasswordTextBox.onkeyup=PasswordStrengthMeter.TextChangedHandler,this.PasswordTextBox.PasswordStrengthManager.EvaluatePassword(),this.ProgressBarDisplayed=!1)};PasswordStrengthMeter.TextChangedHandler=function(){var n=this.PasswordStrengthManager;this.PasswordStrengthManager!="undefined"&&n.EvaluatePassword()};PasswordStrengthMeter.prototype.EvaluatePassword=function(){var n=passwordStrengthLocalizedTextOptions.Weak,t,i;ProgressBar.SetCurrentValue(this.ProgressBarId,1);ProgressBar.SetMeterLevel(this.ProgressBarId,"Urgent");t=this.PasswordTextBox.value;i="1";this.PasswordMeterDiv.style.color="#ffffff";PasswordStrengthMeter.ClientSideStrongPassword(t)?(n=passwordStrengthLocalizedTextOptions.Strong,ProgressBar.SetCurrentValue(this.ProgressBarId,3),ProgressBar.SetMeterLevel(this.ProgressBarId,"Healthy")):PasswordStrengthMeter.ClientSideMediumPassword(t)?(n=passwordStrengthLocalizedTextOptions.Medium,ProgressBar.SetCurrentValue(this.ProgressBarId,2),ProgressBar.SetMeterLevel(this.ProgressBarId,"Caution")):(n=passwordStrengthLocalizedTextOptions.Weak,PasswordStrengthMeter.ClientSideWeakPassword(t)?this.PasswordMeterDiv.style.width="82px":(ProgressBar.SetCurrentValue(this.ProgressBarId,0),this.PasswordMeterDiv.style.color="#737c85",n=passwordStrengthLocalizedTextOptions.Initial));i=="1"&&(this.PasswordMeterDiv.innerHTML="&nbsp;&nbsp;"+n,this.PropertySheetId!=""&&(PropertySheet.ShowRow(this.PropertySheetId),this.ProgressBarDisplayed||(PageLayout.ResizePanels(),this.ProgressBarDisplayed=!0)))};PasswordStrengthMeter.ClientSideStrongPassword=function(n){return PasswordStrengthMeter.IsLongEnough(n,"8")&&PasswordStrengthMeter.SpansEnoughCharacterSets(n,"3")};PasswordStrengthMeter.ClientSideMediumPassword=function(n){return PasswordStrengthMeter.IsLongEnough(n,"8")&&PasswordStrengthMeter.SpansEnoughCharacterSets(n,"2")};PasswordStrengthMeter.ClientSideWeakPassword=function(n){return PasswordStrengthMeter.IsLongEnough(n,"8")};PasswordStrengthMeter.IsLongEnough=function(n,t){return n==null||isNaN(t)?!1:n.length<t?!1:!0};PasswordStrengthMeter.SpansEnoughCharacterSets=function(n,t){var f=0,r=[new PasswordStrengthMeter.CharacterSetChecks("kCapitalLetter",!1),new PasswordStrengthMeter.CharacterSetChecks("kSmallLetter",!1),new PasswordStrengthMeter.CharacterSetChecks("kDigit",!1),new PasswordStrengthMeter.CharacterSetChecks("kPunctuation",!1)],i,u;if(n==null||isNaN(t))return!1;for(u=0;u<n.length;u++)for(i=0;i<r.length;i++)if(!r[i].fResult&&PasswordStrengthMeter.isctype(n.charAt(u),r[i].type)){r[i].fResult=!0;break}for(i=0;i<r.length;i++)r[i].fResult&&f++;return f<t?!1:!0};PasswordStrengthMeter.CharacterSetChecks=function(n,t){this.type=n;this.fResult=t};PasswordStrengthMeter.isctype=function(n,t){var i=!1;switch(t){case"kCapitalLetter":n>="A"&&n<="Z"&&(i=!0);break;case"kSmallLetter":n>="a"&&n<="z"&&(i=!0);break;case"kDigit":n>="0"&&n<="9"&&(i=!0);break;case"kPunctuation":"!@#$%^&*()_+-='\";:[{]}\\|.>,<\/?`~".indexOf(n)>=0&&(i=!0);break;case"kAlpha":(PasswordStrengthMeter.isctype(n,kCapitalLetter)||PasswordStrengthMeter.isctype(n,kSmallLetter))&&(i=!0)}return i}