function StringToByteArrayASCII(n){for(var i=[],t=0;t<n.length;t++)i[t]=n.charCodeAt(t)&127;return i}function StringToByteArrayUnicode(n){for(var i=[],r,t=0;t<n.length;t++)r=n.charCodeAt(t),i[t*2+1]=r>>>8,i[t*2]=r&255;return i}function mapByteToBase64(n){return n>=0&&n<26?String.fromCharCode(65+n):n>=26&&n<52?String.fromCharCode(97+n-26):n>=52&&n<62?String.fromCharCode(48+n-52):n==62?"+":n==63?"/":void 0}function Base64Encode(n,t){for(var r="",i=t;i<4;i++)n=n>>6;for(i=0;i<t;i++)r=mapByteToBase64(n&63)+r,n=n>>6;return r}function ByteArrayToBase64(n){for(var f=n.length,i="",u,r,t=f-3;t>=0;t-=3)r=n[t]|n[t+1]<<8|n[t+2]<<16,i=i+Base64Encode(r,4);for(u=f%3,r=0,t+=2;t>=0;t--)r=r<<8|n[t];return u==0?i=i+Base64Encode(r,4):u==1?i=i+Base64Encode(r<<16,2)+"==":u==2&&(i=i+Base64Encode(r<<8,3)+"="),i}function EncryptedProperties(n,t,r,u){var e=[],f,o;for(e[0]=EncryptionVersion,e[1]=FormatVersion,i=2,f=StringToByteArrayASCII(n),e[i++]=f.length,j=0;j<f.length;j++,i++)e[i]=f[j];for(f=StringToByteArrayUnicode(t),e[i++]=f.length,j=0;j<f.length;j++,i++)e[i]=f[j];for(f=StringToByteArrayASCII(r),e[i++]=f.length,j=0;j<f.length;j++,i++)e[i]=f[j];for(f=StringToByteArrayASCII(u),e[i++]=f.length,j=0;j<f.length;j++,i++)e[i]=f[j];return o=parseRSAKeyFromString(Key),ciphertext=RSAencrypt(e,o,randomNum),ByteArrayToBase64(ciphertext)}function EncryptOldPassword(n){var t=StringToByteArrayUnicode(n),i=parseRSAKeyFromString(Key);return ciphertext=RSAencrypt(t,i,randomNum),ByteArrayToBase64(ciphertext)}function EncryptString(n,t){var i=StringToByteArrayUnicode(t),r=parseRSAKeyFromString(n);return ciphertext=RSAencrypt(i,r,0),ByteArrayToBase64(ciphertext)}var EncryptionVersion=1,FormatVersion=2