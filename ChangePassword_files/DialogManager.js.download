Type.registerNamespace("BOX.JS");BOX.JS.IconType=function(){};BOX.JS.IconType.prototype={none:0,info:1,warn:2,error:3,custom:4};BOX.JS.IconType.registerEnum("BOX.JS.IconType",!1);BOX.JS.DialogType=function(){};BOX.JS.DialogType.prototype={alert:0,confirm:1,freeFormUrl:2,freeFormHtml:3};BOX.JS.DialogType.registerEnum("BOX.JS.DialogType",!1);BOX.JS._tabIndex=function(n,t,i){this.element=n;this.indexValue=t;this.disabled=i};BOX.JS._tabIndex.prototype={indexValue:0,element:null,disabled:null};BOX.JS.DialogInstance=function(n,t,i,r,u){this._tagsSupportingTabIndex=["A","ABBR","ACRONYM","ADDRESS","APPLET","AREA","B","BDO","BIG","BLOCKQUOTE","BODY","BUTTON","CAPTION","CENTER","CITE","CUSTOM","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","hn","HR","I","IFRAME","IMG","INPUT","INS","ISINDEX","KBD","LABEL","LEGEND","LI","LISTING","MARQUEE","MENU","OBJECT","OL","P","PLAINTEXT","PRE","Q","RT","RUBY","S","SAMP","SELECT","SMALL","SPAN","STRIKE","STRONG","SUB","SUP","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TR","TT","U","UL","VAR","XMP"];this.set_parent(n);this._dialogID=t;this._dialogType=u;this._zIndex=1e4+t*3;this.set_settings(i);this.set_dismissAction(r);this._ignoredEventHandler=Function.createDelegate(this,this._ignoreEvent);this._startDragDropHandler=Function.createDelegate(this,this._startDragDrop);this._dragMoveHandler=Function.createDelegate(this,this._onDragMove);this._endDragDropHandler=Function.createDelegate(this,this._endDragDrop);this._initialize()};BOX.JS.DialogInstance.onIFrameReady=function(n,t,i){var s=document.getElementById("waitSpinner"),u,r,h,f,o,e;s!=null&&(s.style.display="none");BOX.JS.DialogInstance.resizeByVisibiltyRestrictions(n,t,i,null);try{u=document.getElementById(i);r=null;u!=null&&(Sys.Browser.agent===Sys.Browser.InternetExplorer?u.contentWindow!=null&&(r=u.contentWindow.document):r=u.contentDocument,r!=null&&r.body!=null&&(u.contentWindow.Button.ResizeButtons(),h=r.getElementsByTagName("head")[0],f=r.createElement("link"),f.setAttribute("rel","stylesheet"),f.setAttribute("type","text/css"),f.setAttribute("href","/css/IFrame.css"),h.appendChild(f),o=r.getElementsByTagName("html")[0],e=$(o).offset().top,e<0&&(e=Math.abs(e),$(o).css("margin-top",e)),r.body.focus()))}catch(c){}};BOX.JS.DialogInstance.resizeByVisibiltyRestrictions=function(n,t,i,r){var e=document.getElementById(i),u,f,o,s;e!=null&&(e.style.height="0px",Sys.Browser.agent!==Sys.Browser.InternetExplorer?(u=e.contentDocument,u!=null&&u.body!=null&&u.body.style.height!=="100%"&&(u.body.style.height="100%")):u=e.contentWindow.document,f=u.body.scrollHeight,r!=null&&(f=Math.max(f,r.y+r.height)),f=f+BOX.JS.DialogInstance._iFrameBodyMarginCompensation,e.style.height=String.format("{0}px",f),o=document.getElementById(n),s=BOX.JS.DialogInstance._findElement(o,t),BOX.JS.DialogManager.centerDialog(o,s,!0))};BOX.JS.DialogInstance._findElement=function(n,t){var u=null,i,r;if(n!=null)if(n.id!=null&&n.id.localeCompare(t)===0)u=n;else{for(i=null,r=0;r<n.childNodes.length;r++)if(i=BOX.JS.DialogInstance._findElement(n.childNodes[r],t),i!=null)break;u=i}return u};BOX.JS.DialogInstance._evaluateClonedScriptTags=function(n,t,i,r){var e=n.getElementsByTagName("script"),o=t.getElementsByTagName("script"),u,f;if(o!=null&&e!=null&&o.length===e.length)for(u=0;u<e.length;u++){var h=o[u],c=e[u],s=c.text;if(i!=null&&r!=null&&i.length===r.length)for(f=0;f<i.length;f++)s=s.replace(i[f],r[f]);try{eval(s);h.text=""}catch(l){Sys.Debug.trace(String.format("failed to evaluate cloned script! got error: '{0}'",l.toString()))}}};BOX.JS.DialogInstance.prototype={_zIndex:0,_dialogID:0,_isIFrameMode:!1,_learnMoreEnabled:!1,_footerEnabled:!1,_previousElementInFocus:null,_originalDefaultButton:null,get_originalDefaultButton:function(){return this._originalDefaultButton},_originalCancelButton:null,get_originalCancelButton:function(){return this._originalCancelButton},_isDragging:!1,_dragStartX:0,_dragStartY:0,_originalHtmlOverflowValue:"",_originalBodyOverflowValue:"",_ignoredEventHandler:null,_startDragDropHandler:null,_dragMoveHandler:null,_endDragDropHandler:null,_savedTabIndexes:null,_parent:null,get_parent:function(){return this._parent},set_parent:function(n){return this._parent=n,n},_settings:null,get_settings:function(){return this._settings},set_settings:function(n){return this._settings=n,n},_element:null,get_element:function(){return this._element},set_element:function(n){return this._element=n,n},_shieldElement:null,get_shieldElement:function(){return this._shieldElement==null&&(this._shieldElement=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogShieldID())),this._shieldElement},_frameElement:null,get_frameElement:function(){return this._frameElement==null&&(this._frameElement=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogFrameID())),this._frameElement},_foregroundElement:null,get_foregroundElement:function(){return this._foregroundElement==null&&(this._foregroundElement=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogForegroundID())),this._foregroundElement},_topRegionElement:null,get_topRegionElement:function(){return this._topRegionElement==null&&(this._topRegionElement=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogTopRegionID())),this._topRegionElement},_dialogBodyElement:null,get_dialogBodyElement:function(){return this._dialogBodyElement==null&&(this._dialogBodyElement=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogBodyAreaID())),this._dialogBodyElement},_dialogContentAreaElement:null,get_dialogContentAreaElement:function(){return this._dialogContentAreaElement==null&&(this._dialogContentAreaElement=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogContentAreaID())),this._dialogContentAreaElement},_acceptButtonElement:null,get_acceptButtonElement:function(){return this._acceptButtonElement==null&&(this._acceptButtonElement=BOX.JS.DialogInstance._findElement(this.get_element(),this._getClonedAcceptButtonID())),this._acceptButtonElement},_dismissButtonElement:null,get_dismissButtonElement:function(){return this._dismissButtonElement==null&&(this._dismissButtonElement=BOX.JS.DialogInstance._findElement(this.get_element(),this._getClonedDismissButtonID())),this._dismissButtonElement},_dismissAction:null,get_dismissAction:function(){return this._dismissAction},set_dismissAction:function(n){return this._dismissAction=n,n},_freezerDiv:null,_dialogType:0,updateHeader:function(n,t,i,r,u){var e=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogIconAreaID()),v,y,p,w,f,b,h,c,a;e.style.display="inline";switch(n){case BOX.JS.IconType.info:v=document.getElementById(this.get_parent().get_infoIconAreaID());v!=null&&(e.innerHTML=v.innerHTML);break;case BOX.JS.IconType.warn:y=document.getElementById(this.get_parent().get_warningIconAreaID());y!=null&&(e.innerHTML=y.innerHTML);break;case BOX.JS.IconType.error:p=document.getElementById(this.get_parent().get_errorIconAreaID());p!=null&&(e.innerHTML=p.innerHTML);break;case BOX.JS.IconType.custom:w=document.createElement("img");w.setAttribute("src",r);e.innerHTML="";e.appendChild(w);break;default:e.style.display="none"}f=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogTitleAreaID());b="DialogManager-FreeFormTitle";(this._dialogType===BOX.JS.DialogType.freeFormHtml||this._dialogType===BOX.JS.DialogType.freeFormUrl)&&(f.className=f.className+" "+b,n!==BOX.JS.IconType.none&&(f.className=f.className.replace(new RegExp(b+".*"),"")));f.innerHTML='<h2 id="titleContainerARIAHeading">'+t+"<\/h2>";h=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogSubTitleAreaID());i!=null&&i.length>0?(h.style.display="block",h.innerHTML=i):h.style.display="none";this.get_settings().get_isFullScreen()||(this.get_settings().get_width()>0&&this.setDialogWidth(),this.get_settings().get_height()>0&&this.setDialogHeight());var s=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogHeaderAreaID()),k=0,d=0,o;if(o=s.currentStyle!=null?s.currentStyle:window.getComputedStyle(s,null),o!=null&&(k=Number.parseInvariant(o.paddingLeft.substr(0,o.paddingLeft.length-2)),d=Number.parseInvariant(o.paddingRight.substr(0,o.paddingRight.length-2))),c=s.getElementsByTagName("table"),c.length>0){var g=c[0].offsetWidth+k+d,nt=c[0].offsetWidth-f.offsetWidth,l=s.offsetWidth;l>this.get_settings().get_width()&&(l=this.get_settings().get_width());g>l&&(f.style.width=(l-k-d-nt).toString()+"px")}u&&u.length>0&&(a=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogCloseIconID()),a&&(a.innerHTML=u,a.style.display="block"))},freezeUserInteraction:function(){this.get_frameElement().disabled=!0;this._freezerDiv=document.createElement("div");this._freezerDiv.className="DialogManager-ForegroundFreezer";this.get_frameElement().appendChild(this._freezerDiv);this._freezerDiv.style.zIndex=this._zIndex+2},thawUserInteraction:function(){this.get_frameElement().disabled=!1;this._freezerDiv!=null&&(this._freezerDiv.parentNode.removeChild(this._freezerDiv),this._freezerDiv=null)},_setContentHtml:function(n,t,i){var u,r,f;this.get_dialogBodyElement().innerHTML=n;u=BOX.JS.DialogInstance._findElement(this.get_element(),this._getClonedAcceptButtonID());r=BOX.JS.DialogInstance._findElement(this.get_element(),this._getClonedDismissButtonID());(t!=null||i!=null)&&(f=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogFooterAreaID()),f.style.display="block",this._footerEnabled=!0);t!=null&&i==null?(Button.SetText(u.id,t),r.parentNode.removeChild(r)):t!=null&&i!=null&&(Button.SetText(u.id,t),Button.SetText(r.id,i))},_setDialogHtml:function(n){this.get_dialogContentAreaElement().innerHTML=n},_setContentUrl:function(n,t){var r,o,s,h,i,f,e,u;this._isIFrameMode=!0;r=this._createIFrame();o=document.createAttribute("src");o.value=t;r.attributes.setNamedItem(o);r.style.height="0px";r.style.width="100%";s=!0;(Sys.Browser.agent!==Sys.Browser.InternetExplorer||BOX.JS.DialogManager.get_isBrowserIE9PlusDocumentMode())&&(s=!1,h=document.createAttribute("onload"),h.value=String.format('BOX.JS.DialogInstance.onIFrameReady("{0}", "{1}", "{2}");',this.get_element().id,this.get_frameElement().id,this.getContentIFrameID()),r.attributes.setNamedItem(h));i=document.createElement("div");i.setAttribute("id","waitSpinner");i.setAttribute("class","Loading-Horizontal AdminWait");i.setAttribute("style","top: 30%; left: 50%;");f=document.createElement("img");f.setAttribute("style","border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; vertical-align: middle; border-left-width: 0px");f.setAttribute("src",this.get_parent().get_spinnerIconUrl());i.appendChild(f);e=document.createElement("div");e.setAttribute("id","frameContainer");e.appendChild(r);i.style.display="block";u=this.get_dialogBodyElement();u.style.paddingLeft="0px";u.style.paddingRight="0px";u.appendChild(i);u.appendChild(e);Sys.Browser.agent===Sys.Browser.InternetExplorer&&s&&window.setTimeout(Function.createDelegate(this,this._resizeContentFrameOnIEReady),0)},_resizeContentFrameOnIEReady:function(){var n,t;try{if(n=document.getElementById(this.getContentIFrameID()),n!=null&&n.contentWindow!=null&&n.contentWindow.document!=null&&n.contentWindow.document.body!=null)if(t=n.contentWindow.document.readyState,t==="complete")BOX.JS.DialogInstance.onIFrameReady(this.get_element().id,this.get_parent().get_dialogFrameID(),n.id);else window.setTimeout(Function.createDelegate(this,this._resizeContentFrameOnIEReady),5);else window.setTimeout(Function.createDelegate(this,this._resizeContentFrameOnIEReady),5)}catch(i){window.setTimeout(Function.createDelegate(this,this._resizeContentFrameOnIEReady),5)}},resizeContentFrame:function(n){BOX.JS.DialogInstance.resizeByVisibiltyRestrictions(this.get_element().id,this.get_parent().get_dialogFrameID(),this.getContentIFrameID(),n)},_createIFrame:function(){var n=document.createElement("iframe"),t,i;return n.id=this.getContentIFrameID(),n.frameBorder="0",t=document.createAttribute("allowTransparency"),t.value="false",n.attributes.setNamedItem(t),i="no",this.get_settings()!=null&&this.get_settings().get_scrollContent()&&(i="yes"),n.scrolling=i,n},dismiss:function(n){this.get_settings().get_isFullScreen()&&(document.body.style.overflow=this._originalBodyOverflowValue,document.body.parentNode.style.overflow=this._originalHtmlOverflowValue,window.detachEvent("onresize",Function.createDelegate(this,this._onBrowserResized)));this.get_settings().get_canDrag()&&(document.body.detachEvent("selectstart",this._ignoredEventHandler),document.body.detachEvent("dragstart",this._ignoredEventHandler));this.get_settings().get_hasShield()&&this._restoreTab();this.get_dismissAction()!=null&&this.get_dismissAction().call(this,n);Button.DefaultButton=this._originalDefaultButton;Button.CancelButton=this._originalCancelButton;this._previousElementInFocus!=null&&this._previousElementInFocus.length>0&&(BOX.JS.DialogManager.get_isBrowserIE7Compatible()?window.setTimeout(Function.createDelegate(this,this._focusPreviousElement),0):this._focusPreviousElement())},center:function(){BOX.JS.DialogManager.centerDialog(this.get_element(),this.get_frameElement(),this._isIFrameMode)},_initialize:function(){var n,t,i,u,r;if(document.activeElement!=null)try{this._previousElementInFocus=document.activeElement.id}catch(f){}this._cloneDialog();n=document.body.getElementsByTagName("form");n!=null&&n.length===1?n[0].appendChild(this.get_element()):document.body.appendChild(this.get_element());this.get_settings()!=null&&(this.get_settings().get_helpUrl()!=null&&this.get_settings().get_helpUrl().length>0&&(t=BOX.JS.DialogInstance._findElement(this.get_element(),this._getClonedHelpButtonID()),t!=null?(t.style.display="inline",t.setAttribute("href",this.get_settings().get_helpUrl())):(i=BOX.JS.DialogInstance._findElement(this.get_element(),this._getClonedLearnMoreLinkID()),u=BOX.JS.DialogInstance._findElement(this.get_element(),this._getClonedLearnMoreAreaID()),i!=null&&(u.style.display="block",i.setAttribute("href",this.get_settings().get_helpUrl()),this._learnMoreEnabled=!0))),this.get_settings().get_showX()||(r=BOX.JS.DialogInstance._findElement(this.get_element(),this._getClonedCloseButtonID()),r!=null&&(r.style.visibility="hidden")),(!this.get_settings().get_showDecoration()||this.get_settings().get_isFullScreen())&&(this.get_settings().get_showDecorationAlways()||this._hideDecoration()),this._originalDefaultButton=Button.DefaultButton,this._originalCancelButton=Button.CancelButton,this.get_settings().get_hasShield()?(this._disableTab(),Button.DefaultButton=this.get_settings().get_defaultActionControlID(),Button.CancelButton=this.get_settings().get_cancelActionControlID()):this._hideShield(),this.get_settings().get_isFullScreen()?(this._originalBodyOverflowValue=document.body.style.overflow,this._originalHtmlOverflowValue=document.body.parentNode.style.overflow,document.body.style.overflow="hidden",document.body.parentNode.style.overflow="hidden",this._setDialogFrameToFullScreen(),window.attachEvent("onresize",Function.createDelegate(this,this._onBrowserResized))):(this.get_settings().get_width()>0&&this.setDialogWidth(),this.get_settings().get_height()>0&&this.setDialogHeight()),this.get_settings().get_canDrag()&&(this.get_topRegionElement().style.cursor="move",document.body.attachEvent("selectstart",this._ignoredEventHandler),document.body.attachEvent("dragstart",this._ignoredEventHandler),this.get_topRegionElement().attachEvent("onmousedown",this._startDragDropHandler)))},_cloneDialog:function(){var a=document.getElementById(this.get_parent().get_dialogAreaID()),i,t,n,r,u,f,e,o,s,h,c,l,v,y,p,w;for(this.set_element(a.cloneNode(!0)),this.get_element().id=this._getClonedControlID(this.get_parent().get_dialogAreaID()),this.get_element().style.zIndex=this._zIndex,i=0;i<this._tagsSupportingTabIndex.length;i++)for(t=this.get_element().getElementsByTagName(this._tagsSupportingTabIndex[i]),n=0;n<t.length;n++)t[n].removeAttribute("tabindex"),this._requireSpecialDisabling(t[n])&&(r=t[n].getAttributeNode("disabled"),r!=null&&t[n].removeAttributeNode(r));u=new RegExp(this.get_parent().get_acceptButtonID(),"gi");f=this._getClonedAcceptButtonID();this.get_element().innerHTML=this.get_element().innerHTML.replace(u,f);e=new RegExp(this.get_parent().get_dismissButtonID(),"gi");o=this._getClonedDismissButtonID();this.get_element().innerHTML=this.get_element().innerHTML.replace(e,o);s=new RegExp(this.get_parent().get_helpLinkID(),"gi");h=this._getClonedHelpButtonID();this.get_element().innerHTML=this.get_element().innerHTML.replace(s,h);c=new RegExp(this.get_parent().get_closeIconID(),"gi");l=this._getClonedCloseButtonID();this.get_element().innerHTML=this.get_element().innerHTML.replace(c,l);v=new RegExp(this.get_parent().get_learnMoreLinkID(),"gi");y=this._getClonedLearnMoreLinkID();this.get_element().innerHTML=this.get_element().innerHTML.replace(v,y);p=new RegExp(this.get_parent().get_learnMoreAreaID(),"gi");w=this._getClonedLearnMoreAreaID();this.get_element().innerHTML=this.get_element().innerHTML.replace(p,w);this.get_shieldElement().style.zIndex=this._zIndex;this.get_foregroundElement().style.zIndex=this._zIndex+1;BOX.JS.DialogInstance._evaluateClonedScriptTags(a,this.get_element(),[u,e,s,c],[f,o,h,l])},_getClonedControlID:function(n){return n+"_"+this._dialogID},_getClonedAcceptButtonID:function(){return this._getClonedControlID(this.get_parent().get_acceptButtonID())},_getClonedDismissButtonID:function(){return this._getClonedControlID(this.get_parent().get_dismissButtonID())},_getClonedHelpButtonID:function(){return this._getClonedControlID(this.get_parent().get_helpLinkID())},_getClonedLearnMoreLinkID:function(){return this._getClonedControlID(this.get_parent().get_learnMoreLinkID())},_getClonedLearnMoreAreaID:function(){return this._getClonedControlID(this.get_parent().get_learnMoreAreaID())},_getClonedCloseButtonID:function(){return this._getClonedControlID(this.get_parent().get_closeIconID())},getContentIFrameID:function(){return this._getClonedControlID("ContentIFrame")},_hideDecoration:function(){var n,t,i,r;this.get_topRegionElement().style.display="none";n=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogBottomRegionID());n.style.display="none";t=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogMiddleRegionID());t.style.borderWidth="0px";i=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogHeaderAreaID());i.style.display="none";r=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogFooterAreaID());r.style.display="none"},_hideShield:function(){this.get_shieldElement().style.display="none"},_disableTab:function(){var e,u,t,n,s,i,f,r;for(this._savedTabIndexes=[],e=[],u=0;u<this._tagsSupportingTabIndex.length;u++)for(t=this.get_element().getElementsByTagName(this._tagsSupportingTabIndex[u]),n=0;n<t.length;n++){var f=t[n].getAttributeNode("tabindex"),h=f!=null&&f.specified,c=h?t[n].tabIndex:Number.NaN,o=null;this._requireSpecialDisabling(t[n])&&(r=t[n].getAttributeNode("disabled"),s=r!=null&&r.specified,o=s?t[n].disabled.toString():null);Array.enqueue(e,new BOX.JS._tabIndex(t[n],c,o))}for(u=0;u<this._tagsSupportingTabIndex.length;u++)for(t=document.getElementsByTagName(this._tagsSupportingTabIndex[u]),n=0;n<t.length;n++){var f=t[n].getAttributeNode("tabindex"),h=f!=null&&f.specified,c=h?t[n].tabIndex:Number.NaN,o=null;t[n].tabIndex=-1;this._requireSpecialDisabling(t[n])&&(r=t[n].getAttributeNode("disabled"),s=r!=null&&r.specified,o=s?t[n].disabled.toString():null,t[n].disabled=!0);Array.enqueue(this._savedTabIndexes,new BOX.JS._tabIndex(t[n],c,o))}do i=Array.dequeue(e),isNaN(i.indexValue)?(f=i.element.getAttributeNode("tabindex"),f!=null&&f.specified&&i.element.removeAttributeNode(f)):i.element.tabIndex=i.indexValue,i.disabled!=null?i.element.disabled=Boolean.parse(i.disabled):(r=i.element.getAttributeNode("disabled"),r!=null&&r.specified&&i.element.removeAttributeNode(r));while(e.length>0)},_requireSpecialDisabling:function(n){var i=!1,t;return n.tagName.toLowerCase()==="input"&&(t=n.attributes.getNamedItem("type"),t.specified&&t.value.toLowerCase()==="radio"&&(i=!0)),i},_restoreTab:function(){var n,t,i;do n=Array.dequeue(this._savedTabIndexes),isNaN(n.indexValue)?(t=n.element.getAttributeNode("tabindex"),t!=null&&t.specified&&n.element.removeAttributeNode(t)):n.element.setAttribute("tabindex",n.indexValue),this._requireSpecialDisabling(n.element)&&(n.disabled!=null?n.element.disabled=Boolean.parse(n.disabled):(i=n.element.getAttributeNode("disabled"),i!=null&&i.specified&&n.element.removeAttributeNode(i)));while(this._savedTabIndexes.length>0);this._savedTabIndexes=null},_setDialogFrameToFullScreen:function(){var n=this.get_frameElement(),t,i,r;n.style.left="0px";n.style.top="0px";n.style.position="fixed";t=BOX.JS.DialogManager.getBrowserDimensions();n.style.width=String.format("{0}px",t.width);n.style.height=String.format("{0}px",t.height);i=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogMiddleRegionID());i.style.width="100%";i.style.height="100%";this.get_dialogContentAreaElement().style.width="100%";this.get_dialogContentAreaElement().style.height="100%";r=this.get_dialogBodyElement();r.style.width=String.format("{0}px",t.width-20);r.style.height="100%"},_onBrowserResized:function(){this._setDialogFrameToFullScreen()},_startDragDrop:function(){var t=window.event,n;if(!this._isDragging){for(this._isDragging=!0,n=t.srcElement,this._dragStartX=t.offsetX,this._dragStartY=t.offsetY;n.id!==this.get_parent().get_dialogFrameID()&&n!=null;)this._dragStartX+=n.offsetLeft,this._dragStartY+=n.offsetTop,n=n.offsetParent;this.get_topRegionElement().detachEvent("onmousedown",this._startDragDropHandler);document.attachEvent("onmousemove",this._dragMoveHandler);document.attachEvent("onmouseup",this._endDragDropHandler)}},_endDragDrop:function(){var n=window.event,t,i;this._isDragging&&(this._isDragging=!1,t=n.clientX,i=n.clientY,this.get_element().style.left=String.format("{0}px",t-this._dragStartX),this.get_element().style.top=String.format("{0}px",i-this._dragStartY),document.detachEvent("onmousemove",this._dragMoveHandler),document.detachEvent("onmouseup",this._endDragDropHandler),this.get_topRegionElement().attachEvent("onmousedown",this._startDragDropHandler))},_onDragMove:function(){var n=window.event,t,i;this._isDragging&&(t=n.clientX,i=n.clientY,this.get_element().style.left=String.format("{0}px",t-this._dragStartX),this.get_element().style.top=String.format("{0}px",i-this._dragStartY),document.selection.clear())},setDialogWidth:function(n){var t=typeof n=="undefined";t?n=this.get_settings().get_width():this.get_settings().set_width(n);this.get_frameElement().style.width=String.format("{0}px",n)},setDialogHeight:function(n){var f=typeof n=="undefined",r,u,i;f?n=this.get_settings().get_height():this.get_settings().set_height(n);this.get_frameElement().style.height=String.format("{0}px",n);var e=this.get_topRegionElement().offsetHeight,o=BOX.JS.DialogInstance._findElement(this.get_frameElement(),this.get_parent().get_dialogBottomRegionID()).offsetHeight,t=n-e-o;t<0&&(t=0);r=BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogMiddleRegionID());r.style.height=String.format("{0}px",t);u=BOX.JS.DialogInstance._findElement(this.get_frameElement(),this.get_parent().get_dialogHeaderAreaID()).offsetHeight;i=t-u;this.get_dialogContentAreaElement().style.height=String.format("{0}px",i);var s=this._learnMoreEnabled?BOX.JS.DialogInstance._findElement(this.get_element(),this._getClonedLearnMoreLinkID()).offsetHeight:0,h=this._footerEnabled?BOX.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogFooterAreaID()).offsetHeight:0,c=i-s-h;this.get_dialogBodyElement().style.height=String.format("{0}px",c)},_getElementBounds:function(n){for(var t=new Sys.UI.Bounds(n.offsetLeft,n.offsetTop,n.offsetWidth,n.offsetHeight);n.parentNode!=null;)t.x+=n.parentNode.offsetLeft,t.y+=n.parentNode.offsetTop,n=n.parentNode;return t},_ignoreEvent:function(){var n=window.event;n.returnValue=!1;n.cancelBubble=!0},_focusPreviousElement:function(){var n=document.getElementById(this._previousElementInFocus);if(n!=null)try{n.focus()}catch(t){}}};BOX.JS.DialogSettings=function(n){var i,r,t;if(this.set_isFullScreen(!1),this.set_height(-1),this.set_width(BOX.JS.DialogManager.get_isMetroUI()?666:400),this.set_scrollContent(!1),this.set_helpUrl(""),this.set_canDrag(!1),this.set_hasShield(!0),this.set_showDecoration(!0),this.set_showDecorationAlways(!1),this.set_defaultActionControlID(null),this.set_cancelActionControlID(null),this.set_showX(!0),n!=null&&(i=n.split(","),i!=null))for(r=0;r<i.length;r++)if(t=i[r].split(":"),t!=null&&t.length>=2)switch(t[0].toLowerCase()){case"fullscreen":this.set_isFullScreen(Boolean.parse(t[1].toLowerCase()));break;case"width":this.set_width(parseInt(t[1].toLowerCase()));break;case"height":this.set_height(parseInt(t[1].toLowerCase()));break;case"scrolling":this.set_scrollContent(Boolean.parse(t[1].toLowerCase()));break;case"drag":this.set_canDrag(Boolean.parse(t[1].toLowerCase()));break;case"hasshield":this.set_hasShield(Boolean.parse(t[1].toLowerCase()));break;case"showdecoration":this.set_showDecoration(Boolean.parse(t[1].toLowerCase()));break;case"showdecorationalways":this.set_showDecorationAlways(Boolean.parse(t[1].toLowerCase()));break;case"helpurl":this.set_helpUrl(i[r].substr(t[0].length+1));break;case"defaultaction":this.set_defaultActionControlID(t[1]);break;case"cancelaction":this.set_cancelActionControlID(t[1]);break;case"showx":this.set_showX(Boolean.parse(t[1].toLowerCase()))}};BOX.JS.DialogSettings.prototype={_isFullSceen:!1,_width:0,_height:0,_scrollContent:!1,_canDrag:!1,_hasShield:!1,_showDecoration:!1,_showDecorationAlways:!1,_helpUrl:null,_defaultActionControlID:null,_cancelActionControlID:null,_showX:!1,get_isFullScreen:function(){return this._isFullSceen},set_isFullScreen:function(n){return this._isFullSceen=n,n},get_width:function(){return this._width},set_width:function(n){return this._width=n,n},get_height:function(){return this._height},set_height:function(n){return this._height=n,n},get_scrollContent:function(){return this._scrollContent},set_scrollContent:function(n){return this._scrollContent=n,n},get_canDrag:function(){return this._canDrag},set_canDrag:function(n){return this._canDrag=n,n},get_hasShield:function(){return this._hasShield},set_hasShield:function(n){return this._hasShield=n,n},get_showDecoration:function(){return this._showDecoration},set_showDecoration:function(n){return this._showDecoration=n,n},get_showDecorationAlways:function(){return this._showDecorationAlways},set_showDecorationAlways:function(n){return this._showDecorationAlways=n,n},get_helpUrl:function(){return this._helpUrl},set_helpUrl:function(n){return this._helpUrl=n,n},get_defaultActionControlID:function(){return this._defaultActionControlID},set_defaultActionControlID:function(n){return this._defaultActionControlID=n,n},get_cancelActionControlID:function(){return this._cancelActionControlID},set_cancelActionControlID:function(n){return this._cancelActionControlID=n,n},get_showX:function(){return this._showX},set_showX:function(n){return this._showX=n,n}};BOX.JS.DialogManager=function(){this._contentCache={}};BOX.JS.DialogManager.get_isRightToLeft=function(){var n=document.getElementsByTagName("html");return n.length>0&&n[0].dir==="rtl"};BOX.JS.DialogManager.get_isMetroUI=function(){var n=document.getElementsByTagName("html");return n.length>0&&n[0].className.indexOf("Page-Metro")>=0};BOX.JS.DialogManager.centerDialog=function(n,t,i){var u=BOX.JS.DialogManager.getBrowserDimensions(),r=(u.width-t.clientWidth)/2,f=(u.height-t.clientHeight)/2;n.style.position="fixed";r>0&&(BOX.JS.DialogManager.get_isRightToLeft()?n.style.right=String.format("{0}px",r):n.style.left=String.format("{0}px",r));n.style.top=String.format("{0}px",f);BOX.JS.DialogManager.forceRedraw(n,i)};BOX.JS.DialogManager.forceRedraw=function(n,t){if(t){BOX.JS.DialogManager._tempTextNode!=null&&BOX.JS.DialogManager._redrawCallback();var i=$get("O365_FooterContainer");BOX.JS.DialogManager._tempDialogDisp=i.style.display;i.style.display="none";BOX.JS.DialogManager._tempTextNode=document.createTextNode(" ");n.appendChild(BOX.JS.DialogManager._tempTextNode);window.setTimeout(Function.createDelegate(null,BOX.JS.DialogManager._redrawCallback),0)}else n.innerHTML=n.innerHTML,window.setTimeout(Function.createDelegate(null,function(){n.innerHTML=n.innerHTML}),0)};BOX.JS.DialogManager.get_isBrowserIE9PlusDocumentMode=function(){return Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.documentMode>=9};BOX.JS.DialogManager.get_isBrowserIE7Compatible=function(){return Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.version==7};BOX.JS.DialogManager._redrawCallback=function(){if(BOX.JS.DialogManager._tempTextNode!=null){var n=BOX.JS.DialogManager._tempTextNode.parentNode;n.removeChild(BOX.JS.DialogManager._tempTextNode);$get("O365_FooterContainer").style.display=BOX.JS.DialogManager._tempDialogDisp;BOX.JS.DialogManager._tempTextNode=null;BOX.JS.DialogManager._tempDialogDisp=null}};BOX.JS.DialogManager.getBrowserDimensions=function(){return new Sys.UI.Bounds(0,0,document.documentElement.clientWidth,document.documentElement.clientHeight)};BOX.JS.DialogManager.prototype={positiveConfirmation:"YES",negativeConfirmation:"NO",_dialogStack:null,_dialogTemplateID:null,get_dialogTemplateID:function(){return this._dialogTemplateID},set_dialogTemplateID:function(n){return this._dialogTemplateID=n,n},_acceptButtonID:null,get_acceptButtonID:function(){return this._acceptButtonID},set_acceptButtonID:function(n){return this._acceptButtonID=n,n},_dismissButtonID:null,get_dismissButtonID:function(){return this._dismissButtonID},set_dismissButtonID:function(n){return this._dismissButtonID=n,n},_dialogAreaID:null,get_dialogAreaID:function(){return this._dialogAreaID},set_dialogAreaID:function(n){return this._dialogAreaID=n,n},_dialogShieldID:null,get_dialogShieldID:function(){return this._dialogShieldID},set_dialogShieldID:function(n){return this._dialogShieldID=n,n},_dialogForegroundID:null,get_dialogForegroundID:function(){return this._dialogForegroundID},set_dialogForegroundID:function(n){return this._dialogForegroundID=n,n},_dialogFrameID:null,get_dialogFrameID:function(){return this._dialogFrameID},set_dialogFrameID:function(n){return this._dialogFrameID=n,n},_dialogTopRegionID:null,get_dialogTopRegionID:function(){return this._dialogTopRegionID},set_dialogTopRegionID:function(n){return this._dialogTopRegionID=n,n},_dialogMiddleRegionID:null,get_dialogMiddleRegionID:function(){return this._dialogMiddleRegionID},set_dialogMiddleRegionID:function(n){return this._dialogMiddleRegionID=n,n},_dialogBottomRegionID:null,get_dialogBottomRegionID:function(){return this._dialogBottomRegionID},set_dialogBottomRegionID:function(n){return this._dialogBottomRegionID=n,n},_dialogContentAreaID:null,get_dialogContentAreaID:function(){return this._dialogContentAreaID},set_dialogContentAreaID:function(n){return this._dialogContentAreaID=n,n},_dialogHeaderAreaID:null,get_dialogHeaderAreaID:function(){return this._dialogHeaderAreaID},set_dialogHeaderAreaID:function(n){return this._dialogHeaderAreaID=n,n},_dialogCloseIconID:null,get_dialogCloseIconID:function(){return this._dialogCloseIconID},set_dialogCloseIconID:function(n){return this._dialogCloseIconID=n,n},_dialogIconAreaID:null,get_dialogIconAreaID:function(){return this._dialogIconAreaID},set_dialogIconAreaID:function(n){return this._dialogIconAreaID=n,n},_dialogTitleAreaID:null,get_dialogTitleAreaID:function(){return this._dialogTitleAreaID},set_dialogTitleAreaID:function(n){return this._dialogTitleAreaID=n,n},_dialogSubTitleAreaID:null,get_dialogSubTitleAreaID:function(){return this._dialogSubTitleAreaID},set_dialogSubTitleAreaID:function(n){return this._dialogSubTitleAreaID=n,n},_dialogBodyAreaID:null,get_dialogBodyAreaID:function(){return this._dialogBodyAreaID},set_dialogBodyAreaID:function(n){return this._dialogBodyAreaID=n,n},_dialogFooterAreaID:null,get_dialogFooterAreaID:function(){return this._dialogFooterAreaID},set_dialogFooterAreaID:function(n){return this._dialogFooterAreaID=n,n},_helpLinkID:null,get_helpLinkID:function(){return this._helpLinkID},set_helpLinkID:function(n){return this._helpLinkID=n,n},_learnMoreLinkID:null,get_learnMoreLinkID:function(){return this._learnMoreLinkID},set_learnMoreLinkID:function(n){return this._learnMoreLinkID=n,n},_learnMoreAreaID:null,get_learnMoreAreaID:function(){return this._learnMoreAreaID},set_learnMoreAreaID:function(n){return this._learnMoreAreaID=n,n},_closeIconID:null,get_closeIconID:function(){return this._closeIconID},set_closeIconID:function(n){return this._closeIconID=n,n},_acceptButtonDefaultText:null,get_acceptButtonDefaultText:function(){return this._acceptButtonDefaultText},set_acceptButtonDefaultText:function(n){return this._acceptButtonDefaultText=n,n},_declineButtonDefaultText:null,get_declineButtonDefaultText:function(){return this._declineButtonDefaultText},set_declineButtonDefaultText:function(n){return this._declineButtonDefaultText=n,n},_dismissButtonDefaultText:null,get_dismissButtonDefaultText:function(){return this._dismissButtonDefaultText},set_dismissButtonDefaultText:function(n){return this._dismissButtonDefaultText=n,n},_infoIconAltText:null,get_infoIconAltText:function(){return this._infoIconAltText},set_infoIconAltText:function(n){return this._infoIconAltText=n,n},_infoIconUrl:null,get_infoIconUrl:function(){return this._infoIconUrl},set_infoIconUrl:function(n){return this._infoIconUrl=n,n},_warningIconAltText:null,get_warningIconAltText:function(){return this._warningIconAltText},set_warningIconAltText:function(n){return this._warningIconAltText=n,n},_warningIconUrl:null,get_warningIconUrl:function(){return this._warningIconUrl},set_warningIconUrl:function(n){return this._warningIconUrl=n,n},_errorIconAltText:null,get_errorIconAltText:function(){return this._errorIconAltText},set_errorIconAltText:function(n){return this._errorIconAltText=n,n},_errorIconUrl:null,get_errorIconUrl:function(){return this._errorIconUrl},set_errorIconUrl:function(n){return this._errorIconUrl=n,n},_spinnerIconUrl:null,get_spinnerIconUrl:function(){return this._spinnerIconUrl},set_spinnerIconUrl:function(n){return this._spinnerIconUrl=n,n},_infoIconID:null,get_infoIconID:function(){return this._infoIconID},set_infoIconID:function(n){return this._infoIconID=n,n},_warningIconID:null,get_warningIconID:function(){return this._warningIconID},set_warningIconID:function(n){return this._warningIconID=n,n},_errorIconID:null,get_errorIconID:function(){return this._errorIconID},set_errorIconID:function(n){return this._errorIconID=n,n},_infoIconAreaID:null,get_infoIconAreaID:function(){return this._infoIconAreaID},set_infoIconAreaID:function(n){return this._infoIconAreaID=n,n},_warningIconAreaID:null,get_warningIconAreaID:function(){return this._warningIconAreaID},set_warningIconAreaID:function(n){return this._warningIconAreaID=n,n},_errorIconAreaID:null,get_errorIconAreaID:function(){return this._errorIconAreaID},set_errorIconAreaID:function(n){return this._errorIconAreaID=n,n},alertText:function(n,t,i,r,u){var f=this._htmlEncode(i);this.alertHtml(n,t,f,r,u,null,null);setTimeout(function(){var n=document.createEvent("Events");n.initEvent("DialogCreated",!0,!0);document.dispatchEvent(n)},1e3)},alertHtml:function(n,t,i,r,u,f,e){var s,h,o,c;(u==null||u.length===0)&&(u=this.get_dismissButtonDefaultText());s=this._getStandardModalSettings();h=typeof f!="undefined";h=h&&f!=null;h&&(Object.getType(f).getName()==="String"?s=new BOX.JS.DialogSettings(f):Object.getType(f).getName()===Object.getType(s).getName()&&(s=f));o=this._createInstance(s,r,BOX.JS.DialogType.alert);o.updateHeader(n,t,null,e);o._setContentHtml(i,u,null);c=document.getElementById(o.get_acceptButtonElement().id);c!=null&&c.focus();Button.SetCancelButton(o.get_acceptButtonElement().id);Button.SetDefaultButton(o.get_acceptButtonElement().id);o.center()},confirmText:function(n,t,i,r,u,f,e){var o=this._htmlEncode(i);this.confirmHtml(n,t,o,r,u,f,e,null)},confirmHtml:function(n,t,i,r,u,f,e,o){var h,c,s,l,a;(u==null||u.length===0)&&(u=this.get_acceptButtonDefaultText());(f==null||f.length===0)&&(f=this.get_declineButtonDefaultText());h=this._getStandardModalSettings();c=typeof o!="undefined";c=c&&o!=null;c&&(Object.getType(o).getName()==="String"?h=new BOX.JS.DialogSettings(o):Object.getType(o).getName()===Object.getType(h).getName()&&(h=o));s=this._createInstance(h,r,BOX.JS.DialogType.confirm);s.updateHeader(n,t,null,null);s._setContentHtml(i,u,f);Button.SetCancelButton(s.get_dismissButtonElement().id);l=s.get_dismissButtonElement().id;e&&(l=s.get_acceptButtonElement().id);Button.SetDefaultButton(l);a=document.getElementById(l);a!=null&&a.focus();s.center()},showUrl:function(n,t,i,r,u){var f=this._getStandardModalSettings();Object.getType(r).getName()==="String"?f=new BOX.JS.DialogSettings(r):Object.getType(r).getName()===Object.getType(f).getName()&&(f=r);this._showUrlInternal(n,t,i,f,u)},_showUrlInternal:function(n,t,i,r,u){var f=this._createInstance(r,i,BOX.JS.DialogType.freeFormUrl);f.updateHeader(BOX.JS.IconType.none,t,null,null,u);f._setContentUrl(t,n);f.center()},showHtmlFromElement:function(n,t,i,r){var u=this._contentCache[n],f;if(u==null){if(f=document.getElementById(n),f==null)throw Error.create(String.format("cannot find element '{0}'",n));u=f.cloneNode(!0);this._contentCache[n]=u;f.innerHTML=""}this.showHtml(u.innerHTML,t,i,r);Button.ResizeButtons()},showHtml:function(n,t,i,r){var u=this._getStandardModalSettings();Object.getType(r).getName()==="String"?u=new BOX.JS.DialogSettings(r):Object.getType(r).getName()===Object.getType(u).getName()&&(u=r);this._showHtmlInternal(n,t,i,u)},_showHtmlInternal:function(n,t,i,r){var u=this._createInstance(r,i,BOX.JS.DialogType.freeFormHtml),f;u.updateHeader(BOX.JS.IconType.none,t,null,null);u._setDialogHtml(n);u.center();r.get_defaultActionControlID()!=null&&r.get_defaultActionControlID().length>0&&(f=document.getElementById(r.get_defaultActionControlID()),f!=null&&f.focus())},dismiss:function(n){var t,i,r;this._dialogStack!=null&&this._dialogStack.length>0&&(t=this._dialogStack.pop(),i=document.getElementById(t.getContentIFrameID()),Sys.Browser.agent===Sys.Browser.InternetExplorer&&i!=null&&(r=document.body.createTextRange(),r.moveToElementText(t.get_frameElement()),r.select()),BOX.JS.DialogManager.get_isBrowserIE9PlusDocumentMode()&&i!=null?(t.get_element().style.display="none",window.setTimeout(Function.createDelegate(this,function(){t.get_element().parentNode.removeChild(t.get_element());t.dismiss(n);t=null}),300)):(t.get_element().parentNode.removeChild(t.get_element()),t.dismiss(n),t=null))},getTopDialogInstance:function(){var n=null;return this._dialogStack!=null&&this._dialogStack.length>0&&(n=this._dialogStack.pop(),this._dialogStack.push(n)),n},_getStandardModalSettings:function(){return new BOX.JS.DialogSettings(null)},_createInstance:function(n,t,i){this._dialogStack==null&&(this._dialogStack=[]);typeof BaseValidator!="undefined"&&BaseValidator.HideAllCallouts(!1);var u=this._dialogStack.length,r=new BOX.JS.DialogInstance(this,u,n,t,i);return this._dialogStack.push(r),r.get_topRegionElement().focus(),r},_htmlEncode:function(n){var t=document.createElement("div"),i=document.createTextNode(n);return t.appendChild(i),t.innerHTML}};BOX.JS._tabIndex.registerClass("BOX.JS._tabIndex");BOX.JS.DialogInstance.registerClass("BOX.JS.DialogInstance");BOX.JS.DialogSettings.registerClass("BOX.JS.DialogSettings");BOX.JS.DialogManager.registerClass("BOX.JS.DialogManager");BOX.JS.DialogInstance._iFrameBodyMarginCompensation=10;BOX.JS.DialogManager._tempTextNode=null