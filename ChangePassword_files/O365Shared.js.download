var O365_NavBar=new function(){var h="O365_NavBar",k="O365_Footer",e="Help",ft="_Clip",et=window.document.documentElement.getAttribute("dir")=="rtl",c=null,d=null,t=null,l=null,n=null,i=null,o=null,s=null,a=null,ot=800,st=900,v=this,ht=window.navigator.userAgent.toLowerCase().indexOf("(ipad;")>=0,g=function(n,t){var i=n.clientX,r=n.clientY;return i>t.left&&i<t.right&&r>t.top&&r<t.bottom},gt=function(n){return i!=null&&(g(n,a)||g(n,o))},u=function(n){var t=document.createElement("div");return t.appendChild(document.createTextNode(n)),t.innerHTML.replace(/\"/g,"&quot;").replace(/\'/g,"&#39;")},y=function(n){var i=n.getBoundingClientRect(),r=window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,u=window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop,t={};return t.left=i.left+r,t.right=i.right+r,t.top=i.top+u,t.bottom=i.bottom+u,t},p=function(n,t){var i=window.document.documentElement;i.addEventListener?i.addEventListener(n,t,!1):i.attachEvent&&i.attachEvent("on"+n,t)},ct=function(t){if(t==null){n.push('<span class="O365_Separator"/>');return}t.TargetWindow==="popup"?(n.push('<a id="O365_SubLink_'),n.push(t.Id),n.push('" role="menuitem"'),n.push(' onblur="O365_NavBar.MenuItemBlur(this);"'),lt(t,ot,st),n.push('"'),n.push('">'),n.push(u(t.Text)),n.push("<\/a>")):(n.push('<a id="O365_SubLink_'),n.push(t.Id),n.push('" role="menuitem"'),n.push(' onblur="O365_NavBar.MenuItemBlur(this);"'),t.TargetWindow&&(n.push(' target="'),n.push(t.TargetWindow),n.push('"')),n.push(' href="'),n.push(t.Url),n.push('">'),n.push(u(t.Text)),n.push("<\/a>"))},lt=function(t,i,r){var u=(screen.width-i)/2,f=(screen.height-r)/2;n.push(String.format(" onclick = \"window.open('{0}', 'O365_PopUp_Window', 'height={1}, width={2}, top={3}, left={4}, scrollbars=yes, resizeable=yes'); return false;\" target=\"_blank\"",t.Url,r,i,f,u))},at=function(t){if(t!=null){var i,r;if(r=t.length,r>0){for(n.push("<div>"),i=0;i<r;i++)ct(t[i]);n.push("<\/div>")}}},nt=function(t,i){n.push('<div id="');n.push(i);n.push('" class="O365_PopupMenu">');at(t);n.push("<\/div>")},w=function(n){var i=n.Id!=null&&n.Id==t.CurrentMainLinkElementID;r(n.Id,n.Url,n.TargetWindow,n.Text,null,null,n.SubLinks,!1,i)},vt=function(n,i){var r=n.Id!=null&&n.Id==t.CurrentMainLinkElementID;yt(n.Id,n.Url,n.TargetWindow,n.Text,n.SubLinks,!1,r,null,i)},yt=function(t,i,r,f,e,o,s,h,c){tt(t,i,r,e,o,h,"preview-flyout-anchor",!0);n.push(u(f));n.push('<img src="');n.push(c);n.push('"/>');n.push("<\/a>")},tt=function(t,i,r,f,o,s,h,c){var p=t==e?t:"O365_MainLink_"+t,a,v,l,y;return n.push('<a id="'),n.push(p),n.push('"'),n.push(' role="menu"'),v=!0,l=f!=null&&f.length>0,l?(i=null,v=!1,a="O365_PopupMenu_"+t,rt(a,o)):n.push(' onfocus="O365_NavBar.HideMenu();"'),r!=null&&(n.push(' target="'),n.push(r),n.push('"')),s!=null&&(n.push(' title="'),n.push(u(s)),n.push('"')),y=!1,i!=null?(n.push(' href="'),n.push(i),n.push('"')):l?n.push(' href="#"'):(n.push(' class="O365_MainLink_Disabled"'),y=!0),h&&!y&&(n.push(' class="'),n.push(h),n.push('"')),c&&n.push(' onclick="if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble = true;}"'),n.push(">"),{setImageTooltip:v,hasMenu:l,menuId:a}},r=function(i,r,e,o,s,h,c,l,a,v){var y=tt(i,r,e,c,l,v),p=y.setImageTooltip,w=y.hasMenu,b=y.menuId;s==null?(n.push(u(o)),w&&(f(t.DownWhiteArrowImage.ClipInfo,null,null,!0,!1,!1),f(t.DownWhiteArrowImage.HoverClipInfo,null,null,!0,!0,!1))):(f(s,null,o,!0,!1,p),f(h,null,o,!0,!0,p));a&&f(t.UpArrowImage.ClipInfo,"O365_ActiveLinkIndicator",null,!1,!1,!1);n.push("<\/a>");w&&nt(c,b)},pt=function(t,i,r,f,o,s,h,c){var v=t==e?t:"O365_MainLink_"+t,a,l;n.push("<span style=\"padding: 0 10px; font-family:'Segoe UI'; font-weight: bold; background-color: #00ACED; font-size: 18px;\">");n.push('<a id="');n.push(v);n.push('"');n.push(' role="menu"');l=o!=null&&o.length>0;l?(i=null,a="O365_PopupMenu_"+t,rt(a,s)):n.push(' onfocus="O365_NavBar.HideMenu();"');r!=null&&(n.push(' target="'),n.push(r),n.push('"'));c!=null&&(n.push(' title="'),n.push(u(c)),n.push('"'));i!=null?(n.push(' href="'),n.push(i),n.push('"')):l?n.push(' href="#"'):n.push(' class="O365_MainLink_Disabled"');n.push(' style="background-color: #00ACED;">?<\/a><\/span>');l&&nt(o,a)},it=function(){n.push('<div id="previewButton" class="preview-badge" onmouseover="O365_NavBar.ShowAndHideChildElements(null, this, \'previewFlyout\', \'previewButton\'); return false;">');t.PreviewButtonText!=null&&n.push(t.PreviewButtonText);n.push("<\/div>");n.push('<div id="previewFlyout" class="preview-flyout"; style="display:none;" onmouseout="O365_NavBar.ShowAndHideChildElements(event, this, \'previewButton\', \'previewFlyout\'); return false;">');n.push('<div class="preview-title">');t.PreviewSiteTitleText!=null&&n.push(t.PreviewSiteTitleText);n.push("<\/div>");n.push("<p>");t.PreviewWelcomeText!=null&&n.push(t.PreviewWelcomeText);n.push("<\/p>");vt(t.PreviewFeedbackLink,t.PreviewFeedbackImageSrc);n.push("<\/div>")},wt=function(n,t,i){r("TenantName",null,null,n,null,null,t,!0,!1,i)},ni=function(){n.push('<span style="width: 20px; padding-left: 20px;  "><\/span>')},rt=function(t,i){for(var u=["onfocus","onclick"],f=u.length,r=0;r<f;r++)n.push(" "),n.push(u[r]),n.push("=\"O365_NavBar.ShowMenu(this, '"),n.push(t),n.push("', "),n.push(i),n.push(");"),u[r]=="onclick"&&n.push("O365_NavBar.KillEvent(event);"),n.push('"')},f=function(i,r,f,e,o,s){if(ht&&(e=!1),!o||e){var h=e?o?"O365_HoverImg":"O365_MainImg":"O365_MainImgNoHover";n.push("<span");r!=null&&(n.push(' id="'),n.push(r),n.push(ft),n.push('"'));n.push(' class="O365_ImgClip ');n.push(h);n.push('" style="height:');n.push(i.Height);n.push("px;width:");n.push(i.Width);n.push('px;"><img');r!=null&&(n.push(' id="'),n.push(r),n.push('"'));n.push(' class="');n.push(h);n.push('" src="');n.push(t.ImageClusterUrl);n.push('" style="left:-');n.push(i.X);n.push("px;top:-");n.push(i.Y);n.push('px;"');f!=null&&(f=u(f),n.push(' alt="'),n.push(f),n.push('"'),(o||!e)&&s&&(n.push(' title="'),n.push(f),n.push('"')));n.push("/><\/span>")}},bt=function(){var i,u,s,c,f,o,a;if(t.IsAuthenticated){if(n.push('<div id="'),n.push(h),t.DisableNavAndTitle?n.push('"'):n.push('" onclick="O365_NavBar.OnLinkClicked(event);"'),n.push('><span id="O365_Logo" tabindex="0" role="presentation">'),t.DisableNavAndTitle?r("Logo",null,null,t.LogoImage.AltText,t.LogoImage.ClipInfo,t.LogoImage.HoverClipInfo,null,!1,!1):r("Logo",t.LogoNavigationUrl,null,t.LogoImage.AltText,t.LogoImage.ClipInfo,t.LogoImage.HoverClipInfo,null,!1,!1),n.push("<\/span>"),n.push('<span id="O365_PreviewButton">'),it(),n.push('<\/span><span id="O365_TopMenu">'),t.WorkloadLinks)for(u=t.WorkloadLinks.length,i=0;i<u;i++)w(t.WorkloadLinks[i]);if(t.AppsLinks&&r("Apps",null,null,t.AppsImage.AltText,t.AppsImage.ClipInfo,t.AppsImage.HoverClipInfo,t.AppsLinks,!1,!1),t.AdminLink&&w(t.AdminLink),t.PartnerLink&&w(t.PartnerLink),t.UserDisplayName){if(t.TruncatedUserDisplayName?(s=t.TruncatedUserDisplayName,c=t.UserDisplayName):(s=t.UserDisplayName,c=null),f=[],i=0,t.AboutMeLink&&(f[i++]=t.AboutMeLink),t.O365SettingsLink){if(t.CurrentWorkloadSettingsSubLinks&&(u=t.CurrentWorkloadSettingsSubLinks.length,u>0))for(o=0;o<u;o++,i++)f[i]=t.CurrentWorkloadSettingsSubLinks[o];i>0&&(f[i++]=null);t.CurrentWorkloadSettingsLink&&(f[i++]=t.CurrentWorkloadSettingsLink);t.O365SettingsLink&&(f[i++]=t.O365SettingsLink)}if(t.SignOutLink&&(f[i++]=t.SignOutLink),t.CurrentWorkloadUserSubLinks&&(i>0&&(f[i++]=null),u=t.CurrentWorkloadUserSubLinks.length,u>0))for(o=0;o<u;o++,i++)f[i]=t.CurrentWorkloadUserSubLinks[i];t.DisableNavAndTitle?r("Me",null,null,s,null,null,null,!0,!1,c):r("Me",null,null,s,null,null,f,!0,!1,c)}r("VerticalSep1",null,null,"|",null,null,null,!0,!1);var l,p=0,v=0,y=[];if(t.TenantNameSubLinks&&(v=t.TenantNameSubLinks.length,v>0))for(l=0;l<v;l++)y[p++]=t.TenantNameSubLinks[l];if(t.ShowTenantName&&y.length>=1&&(wt(t.TenantInformation.Text,y,t.TenantInformation.Text),r("VerticalSep2",null,null,"|",null,null,null,!0,!1)),t.HelpLink){if(a=null,t.CurrentWorkloadHelpSubLinks&&(u=t.CurrentWorkloadHelpSubLinks.length,u>0))for(a=[],i=0;i<u;i++)a[i]=t.CurrentWorkloadHelpSubLinks[i];pt(e,t.HelpLink.Url,t.HelpLink.TargetWindow,t.HelpLink.Text,a,!0,!1)}n.push("<\/span><\/div>")}else n.push('<div id="'),n.push(h),n.push('" onclick="O365_NavBar.OnLinkClicked(event);"'),n.push('><span id="O365_Logo" tabindex="0" role="presentation">'),r("Logo",t.LogoNavigationUrl,null,t.LogoImage.AltText,t.LogoImage.ClipInfo,t.LogoImage.HoverClipInfo,null,!1,!1),n.push('<\/span><span id="O365_PreviewButton">'),it(),n.push("<\/span><\/div>")},kt=function(){n.push('<div id="O365_Footer_Internal">');n.push('<span style="float: left;" id="');n.push(k);n.push('">');t.FooterCopyrightText!=null&&(n.push('<span id="O365_CopyrightText">'),n.push(t.FooterCopyrightText),n.push("<\/span>"));b(t.LegalLink);t.LegalLink!=null&&ut();dt(t.PrivacyLink);b(t.CommunityLink);t.CommunityLink!=null&&ut();b(t.FeedbackLink);t.FooterLogoImage&&(n.push('<span style="padding: 0 8px 0 0;" id="O365_FooterLogo">'),f(t.FooterLogoImage.ClipInfo,null,null,!1,!1,!1),n.push("<\/span>"));n.push("<\/span>");n.push("<\/div>")},b=function(t){t!=null&&(n.push('<span><a id="'),n.push(t.Id),n.push('" href="'),n.push(t.Url),t.TargetWindow&&(n.push('" target="'),n.push(t.TargetWindow)),n.push('">'),n.push(t.Text),n.push("<\/a><\/span>"))},dt=function(t){t!=null&&(n.push('<span style="width: 100%"><a id="'),n.push(t.Id),n.push('" href="'),n.push(t.Url),t.TargetWindow&&(n.push('" target="'),n.push(t.TargetWindow)),n.push('">'),n.push(t.Text),n.push("<\/a><\/span>"))},ut=function(){n.push('<span class="O365_Separator">|<\/span>')};this.KillEvent=function(n){n.preventDefault?n.preventDefault():n.returnValue=!1;n.stopPropagation?n.stopPropagation():n.cancelBubble=!0};this.HideMenuOnBlur=function(){var t,r,n;if(i!=null){if(t=!0,r=document.activeElement,r!=null)for(n=r.parentNode;n!=null;){if(n==i){t=!1;break}n=n.parentNode}t&&this.HideMenu()}};this.HideMenu=function(){i!=null&&(i.style.display="none",i.style.left="10000px",i=null);s!=null&&(s.className="",s=null)};this.ShowMenu=function(n,t,r,u,f){var e=document.getElementById(t),p,h,l,v,w;e!==i&&(this.HideMenu(),n.className="O365_MenuOwner",i=e,s=n,a=y(n),p=y(c),e.style.display="inline-block",l=e.offsetWidth,typeof r=="undefined"&&(r=!1),et&&(r=!r),h=r?n.offsetLeft+n.offsetWidth-l:n.offsetLeft,typeof u!="undefined"&&typeof f!="undefined"?(e.style.left=u,e.style.top=f):(v=$(window).width(),h+l>v&&(h=v-l),e.style.left=h+"px",e.style.top=p.bottom+"px"),w=y(e),o=w,o.top=Math.min(o.top,a.bottom-1))};this.ShowAndHideChildElements=function(n,t,i,r){var u,e,f;i&&r&&(!n||n.toElement&&n.toElement.id!==t.id&&n.toElement.parentNode!==t)&&(u=$get(r),u!=null&&(e=u.getBoundingClientRect().top-u.getBoundingClientRect().bottom,u.style.display="none"),f=$get(i),f!=null&&(f.style.position=="absolute"&&(f.style.top=e),f.style.display=""))};this.MenuItemBlur=function(n){for(var t=n.parentNode;t!=null&&t.className!="O365_PopupMenu";)t=t.parentNode;t==i&&this.HideMenuOnBlur()};this.ShowHelp=function(n){n!=null&&n!="#"&&n!=""&&window.open(n,"O365Help")};this.OnLinkClicked=function(n){for(var t=n.target?n.target:n.srcElement,i=null,r,u;t!=null&&t!=c&&t!=d;){if(t.tagName!=null&&t.tagName.toUpperCase()=="A"){i=t;break}t=t.parentNode}i!=null&&(r=i.id==e,r&&this.ShowHelp(i.href),u=l!=null?l(i):!0,(!u||r)&&this.KillEvent(n))};this.Render=function(n,t,i){this.RenderNavBarAndFooter(n,null,t,i)};this.RenderNavBarAndFooter=function(i,r,u,f){var e,o;u!=null&&(t=u,l=f,i!=null&&(e=document.getElementById(i),e!=null&&(n=[],bt(),e.innerHTML=n.join(""),c=document.getElementById(h))),r!=null&&(o=document.getElementById(r),o!=null&&(n=[],kt(),o.innerHTML=n.join(""),d=document.getElementById(k))),n=null,t=null)};p("keydown",function(n){var t=27;(n.which==t||n.keyCode==t)&&v.HideMenu()});p("click",function(){v.HideMenu()});p("contextmenu",function(){v.HideMenu()})}