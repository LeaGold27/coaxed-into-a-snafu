function parseRSAKeyFromString(b){var c=b.indexOf(";");if(c<0)return null;var f=b.substr(0,c),e=b.substr(c+1),a=f.indexOf("=");if(a<0)return null;var g=f.substr(a+1);a=e.indexOf("=");if(a<0)return null;var h=e.substr(a+1),d={};d["n"]=hexStringToMP(h);d["e"]=parseInt(g,16);return d}function RSAencrypt(a,e,h){var c=e.n,i=e.e,j=a.length,f=c.size*2,g=42;if(j+g>f)return null;applyPKCSv2Padding(a,f,h);a=a.reverse();var k=byteArrayToMP(a),d=modularExp(k,i,c);d.size=c.size;var b=mpToByteArray(d);b=b.reverse();return b}function JSMPnumber(){this.size=1;this.data=[];this.data[0]=0}function duplicateMP(b){var a=new JSMPnumber;a.size=b.size;a.data=b.data.slice(0);return a}function byteArrayToMP(c){for(var b=new JSMPnumber,a=0,d=c.length,e=d>>1,a=0;a<e;a++)b.data[a]=c[2*a]+(c[1+2*a]<<8);if(d%2)b.data[a++]=c[d-1];b.size=a;return b}function mpToByteArray(c){for(var b=[],a=0,d=c.size,a=0;a<d;a++){b[a*2]=c.data[a]&255;b[a*2+1]=c.data[a]>>>8}return b}function modularExp(f,b,e){var g=[],c=0;while(b>0){g[c]=b&1;b=b>>>1;c++}for(var a=duplicateMP(f),d=c-2;d>=0;d--){a=modularMultiply(a,a,e);if(g[d]==1)a=modularMultiply(a,f,e)}return a}function modularMultiply(e,d,b){var c=multiplyMP(e,d),a=divideMP(c,b);return a.r}function multiplyMP(d,f){var c=new JSMPnumber;c.size=d.size+f.size;for(var b,a=0;a<c.size;a++)c.data[a]=0;var e=d.data,h=f.data,g=c.data;if(d==f){for(a=0;a<d.size;a++)g[2*a]+=e[a]*e[a];for(a=1;a<d.size;a++)for(b=0;b<a;b++)g[a+b]+=2*e[a]*e[b]}else for(a=0;a<d.size;a++)for(b=0;b<f.size;b++)g[a+b]+=e[a]*h[b];normalizeJSMP(c);return c}function normalizeJSMP(d){var c,b,g,a,e,f;g=d.size;b=0;for(c=0;c<g;c++){a=d.data[c];a+=b;f=a;b=Math.floor(a/65536);a-=b*65536;e=b*65536+a-f;e!=0&&alert(e);d.data[c]=a}}function removeLeadingZeroes(a){var b=a.size-1;while(b>0&&a.data[b--]==0)a.size--}function divideMP(a,b){var h=a.size,c=b.size,m=h-c+1,l=b.data[c-1],k=b.data[c-1]+b.data[c-2]/65536,i=new JSMPnumber;i.size=h-c+1;a.data[h]=0;for(var e=h-1;e>=c-1;e--){var f=e-c+1,d=Math.floor((a.data[e+1]*65536+a.data[e])/k);if(d>0){var g=multiplyAndSubtract(a,d,b,f);if(g<0){d--;multiplyAndSubtract(a,d,b,f)}while(g>0&&a.data[e]>=l){g=multiplyAndSubtract(a,1,b,f);if(g>0)d++}}i.data[f]=d}var j={};j["q"]=i;removeLeadingZeroes(a);j["r"]=a;return j}function multiplyAndSubtract(f,i,g,d){for(var h=f.data.slice(0),b=0,e=f.data,a=0;a<g.size;a++){var c=b+g.data[a]*i;b=c>>>16;c=c-b*65536;if(c>e[a+d]){e[a+d]+=65536-c;b++}else e[a+d]-=c}if(b>0)e[a+d]-=b;if(e[a+d]<0){f.data=h.slice(0);return -1}return +1}function applyPKCSv2Padding(d,g,e){for(var n=d.length,m=[218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9],i=g-n-40-2,f=[],a=0;a<i;a++)f[a]=0;f[i]=1;var o=m.concat(f,d),p=e?e.length:0,c=[];for(a=0;a<20;a++)c[a]=Math.floor(Math.random()*256);c=SHA1(c.concat(e));var l=MGF(c,g-21),h=XORarrays(o,l),k=MGF(h,20),j=XORarrays(c,k),b=[];b[0]=0;b=b.concat(j,h);for(a=0;a<b.length;a++)d[a]=b[a]}function MGF(f,d){if(d>4096)return null;var a=f.slice(0),b=a.length;a[b++]=0;a[b++]=0;a[b++]=0;a[b]=0;var e=0,c=[];while(c.length<d){a[b]=e++;c=c.concat(SHA1(a))}return c.slice(0,d)}function XORarrays(b,d){if(b.length!=d.length)return null;for(var c=[],e=b.length,a=0;a<e;a++)c[a]=b[a]^d[a];return c}function SHA1(e){var c,d=e.slice(0);PadSHA1Input(d);var a={};a["A"]=1732584193;a["B"]=4023233417;a["C"]=2562383102;a["D"]=271733878;a["E"]=3285377520;for(c=0;c<d.length;c+=64)SHA1RoundFunction(a,d,c);var b=[];wordToBytes(a.A,b,0);wordToBytes(a.B,b,4);wordToBytes(a.C,b,8);wordToBytes(a.D,b,12);wordToBytes(a.E,b,16);return b}function wordToBytes(a,d,c){for(var b=3;b>=0;b--){d[c+b]=a&255;a=a>>>8}}function PadSHA1Input(c){var b=c.length,f=b,e=b%64,g=e<55?56:120,a,h=b-e;c[f++]=128;for(a=e+1;a<g;a++)c[f++]=0;var d=b*8;for(a=1;a<8;a++){c[f+8-a]=d&255;d=d>>>8}}function SHA1RoundFunction(b,m,n){var i=4294967295,o=1518500249,p=1859775393,q=2400959708,r=3395469782,a,g,l,h=[],f=b.A,c=b.B,d=b.C,e=b.D,j=b.E;for(g=0,l=n;g<16;g++,l+=4)h[g]=m[l]<<24|m[l+1]<<16|m[l+2]<<8|m[l+3]<<0;for(g=16;g<80;g++)h[g]=rotateLeft(h[g-3]^h[g-8]^h[g-14]^h[g-16],1);var k;for(a=0;a<20;a++){k=rotateLeft(f,5)+(c&d|~c&e)+j+h[a]+o&i;j=e;e=d;d=rotateLeft(c,30);c=f;f=k}for(a=20;a<40;a++){k=rotateLeft(f,5)+(c^d^e)+j+h[a]+p&i;j=e;e=d;d=rotateLeft(c,30);c=f;f=k}for(a=40;a<60;a++){k=rotateLeft(f,5)+(c&d|c&e|d&e)+j+h[a]+q&i;j=e;e=d;d=rotateLeft(c,30);c=f;f=k}for(a=60;a<80;a++){k=rotateLeft(f,5)+(c^d^e)+j+h[a]+r&i;j=e;e=d;d=rotateLeft(c,30);c=f;f=k}b.A=b.A+f&i;b.B=b.B+c&i;b.C=b.C+d&i;b.D=b.D+e&i;b.E=b.E+j&i}function rotateLeft(b,a){var c=b>>>32-a,e=(1<<32-a)-1,d=b&e;return d<<a|c}function hexStringToMP(e){var a,d,b=Math.ceil(e.length/4),c=new JSMPnumber;c.size=b;for(a=0;a<b;a++){d=e.substr(a*4,4);c.data[b-1-a]=parseInt(d,16)}return c}